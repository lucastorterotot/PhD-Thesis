#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import numpy as np

import ltLaTeXpyplot as lt

# Créer la figure
fig = lt.ltFigure(name='benchmark', width_frac = .7)

# Définir les grandeurs

# format is script, Nevents, user time, system time , wall clock, date start (all iters), date end (all iters), in seconds
times = [
    ["SVFit", 1, 1.09, 0.52, 2.96, 1614930176.209457577, 1614930219.195454049],
    ["SVFit", 1, 0.99, 0.45, 1.81, 1614930176.209457577, 1614930219.195454049],
    ["SVFit", 1, 1.10, 0.44, 1.91, 1614930176.209457577, 1614930219.195454049],
    ["SVFit", 1, 1.07, 0.47, 1.91, 1614930176.209457577, 1614930219.195454049],
    ["SVFit", 1, 1.07, 0.51, 1.99, 1614930176.209457577, 1614930219.195454049],
    ["SVFit", 1, 0.99, 0.46, 1.80, 1614930176.209457577, 1614930219.195454049],
    ["SVFit", 1, 1.06, 0.44, 1.87, 1614930176.209457577, 1614930219.195454049],
    ["SVFit", 1, 1.06, 0.49, 1.93, 1614930176.209457577, 1614930219.195454049],
    ["SVFit", 1, 1.04, 0.53, 1.97, 1614930176.209457577, 1614930219.195454049],
    ["SVFit", 1, 1.04, 0.46, 1.90, 1614930176.209457577, 1614930219.195454049],
    ["SVFit", 1, 1.32, 0.51, 2.52, 1614930176.209457577, 1614930219.195454049],
    ["SVFit", 1, 1.54, 0.48, 4.17, 1614930176.209457577, 1614930219.195454049],
    ["SVFit", 1, 1.10, 0.49, 2.32, 1614930176.209457577, 1614930219.195454049],
    ["SVFit", 1, 1.06, 0.50, 1.98, 1614930176.209457577, 1614930219.195454049],
    ["SVFit", 1, 1.04, 0.49, 1.95, 1614930176.209457577, 1614930219.195454049],
    ["SVFit", 1, 1.11, 0.50, 2.01, 1614930176.209457577, 1614930219.195454049],
    ["SVFit", 1, 1.07, 0.48, 1.97, 1614930176.209457577, 1614930219.195454049],
    ["SVFit", 1, 1.09, 0.46, 1.92, 1614930176.209457577, 1614930219.195454049],
    ["SVFit", 1, 1.02, 0.49, 1.92, 1614930176.209457577, 1614930219.195454049],
    ["SVFit", 1, 1.03, 0.48, 1.91, 1614930176.209457577, 1614930219.195454049],
    ["DNN",   1, 2.55, 1.59, 7.65, 1614930219.199097907, 1614930309.910298952],
    ["DNN",   1, 2.41, 1.54, 4.24, 1614930219.199097907, 1614930309.910298952],
    ["DNN",   1, 2.37, 1.56, 4.07, 1614930219.199097907, 1614930309.910298952],
    ["DNN",   1, 2.34, 1.40, 4.86, 1614930219.199097907, 1614930309.910298952],
    ["DNN",   1, 2.21, 1.16, 3.97, 1614930219.199097907, 1614930309.910298952],
    ["DNN",   1, 2.46, 1.06, 4.15, 1614930219.199097907, 1614930309.910298952],
    ["DNN",   1, 2.49, 1.32, 4.29, 1614930219.199097907, 1614930309.910298952],
    ["DNN",   1, 2.28, 1.14, 3.99, 1614930219.199097907, 1614930309.910298952],
    ["DNN",   1, 2.29, 1.17, 4.07, 1614930219.199097907, 1614930309.910298952],
    ["DNN",   1, 2.39, 1.25, 4.11, 1614930219.199097907, 1614930309.910298952],
    ["DNN",   1, 2.23, 1.07, 3.90, 1614930219.199097907, 1614930309.910298952],
    ["DNN",   1, 2.27, 1.15, 4.08, 1614930219.199097907, 1614930309.910298952],
    ["DNN",   1, 2.30, 1.11, 4.10, 1614930219.199097907, 1614930309.910298952],
    ["DNN",   1, 2.15, 1.18, 3.89, 1614930219.199097907, 1614930309.910298952],
    ["DNN",   1, 2.68, 1.63, 7.55, 1614930219.199097907, 1614930309.910298952],
    ["DNN",   1, 2.38, 1.15, 4.05, 1614930219.199097907, 1614930309.910298952],
    ["DNN",   1, 2.42, 1.22, 4.30, 1614930219.199097907, 1614930309.910298952],
    ["DNN",   1, 2.47, 1.29, 4.98, 1614930219.199097907, 1614930309.910298952],
    ["DNN",   1, 2.20, 1.09, 3.96, 1614930219.199097907, 1614930309.910298952],
    ["DNN",   1, 2.57, 1.18, 4.24, 1614930219.199097907, 1614930309.910298952],
    ["SVFit",10, 2.09, 0.45, 3.09, 1614930309.918801514, 1614930372.713883172],
    ["SVFit",10, 2.09, 0.41, 2.93, 1614930309.918801514, 1614930372.713883172],
    ["SVFit",10, 2.08, 0.44, 2.95, 1614930309.918801514, 1614930372.713883172],
    ["SVFit",10, 2.04, 0.44, 2.89, 1614930309.918801514, 1614930372.713883172],
    ["SVFit",10, 2.22, 0.43, 3.07, 1614930309.918801514, 1614930372.713883172],
    ["SVFit",10, 2.61, 0.43, 4.07, 1614930309.918801514, 1614930372.713883172],
    ["SVFit",10, 2.17, 0.44, 3.50, 1614930309.918801514, 1614930372.713883172],
    ["SVFit",10, 2.07, 0.44, 2.89, 1614930309.918801514, 1614930372.713883172],
    ["SVFit",10, 2.09, 0.46, 2.98, 1614930309.918801514, 1614930372.713883172],
    ["SVFit",10, 2.06, 0.41, 2.86, 1614930309.918801514, 1614930372.713883172],
    ["SVFit",10, 2.10, 0.44, 2.94, 1614930309.918801514, 1614930372.713883172],
    ["SVFit",10, 2.09, 0.52, 3.03, 1614930309.918801514, 1614930372.713883172],
    ["SVFit",10, 2.14, 0.57, 3.13, 1614930309.918801514, 1614930372.713883172],
    ["SVFit",10, 2.01, 0.51, 2.94, 1614930309.918801514, 1614930372.713883172],
    ["SVFit",10, 2.04, 0.52, 2.96, 1614930309.918801514, 1614930372.713883172],
    ["SVFit",10, 2.03, 0.53, 2.96, 1614930309.918801514, 1614930372.713883172],
    ["SVFit",10, 2.13, 0.61, 3.73, 1614930309.918801514, 1614930372.713883172],
    ["SVFit",10, 2.04, 0.56, 3.07, 1614930309.918801514, 1614930372.713883172],
    ["SVFit",10, 2.00, 0.54, 3.64, 1614930309.918801514, 1614930372.713883172],
    ["SVFit",10, 1.96, 0.53, 2.89, 1614930309.918801514, 1614930372.713883172],
    ["DNN",  10, 2.66, 1.62, 8.01, 1614930372.718440977, 1614930466.001463803],
    ["DNN",  10, 2.27, 1.20, 4.01, 1614930372.718440977, 1614930466.001463803],
    ["DNN",  10, 2.15, 1.22, 3.90, 1614930372.718440977, 1614930466.001463803],
    ["DNN",  10, 2.16, 1.15, 3.85, 1614930372.718440977, 1614930466.001463803],
    ["DNN",  10, 2.18, 1.24, 3.96, 1614930372.718440977, 1614930466.001463803],
    ["DNN",  10, 2.37, 1.10, 4.20, 1614930372.718440977, 1614930466.001463803],
    ["DNN",  10, 2.41, 1.47, 4.09, 1614930372.718440977, 1614930466.001463803],
    ["DNN",  10, 2.25, 1.12, 3.95, 1614930372.718440977, 1614930466.001463803],
    ["DNN",  10, 2.18, 1.13, 3.89, 1614930372.718440977, 1614930466.001463803],
    ["DNN",  10, 2.44, 1.60, 4.30, 1614930372.718440977, 1614930466.001463803],
    ["DNN",  10, 2.30, 1.22, 4.23, 1614930372.718440977, 1614930466.001463803],
    ["DNN",  10, 2.31, 1.26, 4.70, 1614930372.718440977, 1614930466.001463803],
    ["DNN",  10, 2.22, 1.09, 3.90, 1614930372.718440977, 1614930466.001463803],
    ["DNN",  10, 2.24, 1.11, 3.93, 1614930372.718440977, 1614930466.001463803],
    ["DNN",  10, 2.76, 1.85, 7.36, 1614930372.718440977, 1614930466.001463803],
    ["DNN",  10, 2.23, 1.17, 4.02, 1614930372.718440977, 1614930466.001463803],
    ["DNN",  10, 2.34, 1.15, 4.02, 1614930372.718440977, 1614930466.001463803],
    ["DNN",  10, 3.32, 2.38, 8.03, 1614930372.718440977, 1614930466.001463803],
    ["DNN",  10, 2.59, 1.81, 4.73, 1614930372.718440977, 1614930466.001463803],
    ["DNN",  10, 2.20, 1.14, 3.95, 1614930372.718440977, 1614930466.001463803],
    ["SVFit", 1e2, 12.11, 0.50, 13.15, 1614930466.010683246, 1614930732.194202054],
    ["SVFit", 1e2, 12.04, 0.56, 13.04, 1614930466.010683246, 1614930732.194202054],
    ["SVFit", 1e2, 12.11, 0.61, 13.77, 1614930466.010683246, 1614930732.194202054],
    ["SVFit", 1e2, 12.02, 0.50, 12.95, 1614930466.010683246, 1614930732.194202054],
    ["SVFit", 1e2, 12.08, 0.51, 13.00, 1614930466.010683246, 1614930732.194202054],
    ["SVFit", 1e2, 12.09, 0.55, 13.09, 1614930466.010683246, 1614930732.194202054],
    ["SVFit", 1e2, 12.07, 0.49, 12.99, 1614930466.010683246, 1614930732.194202054],
    ["SVFit", 1e2, 12.39, 0.59, 13.54, 1614930466.010683246, 1614930732.194202054],
    ["SVFit", 1e2, 13.72, 0.55, 14.70, 1614930466.010683246, 1614930732.194202054],
    ["SVFit", 1e2, 12.22, 0.53, 13.21, 1614930466.010683246, 1614930732.194202054],
    ["SVFit", 1e2, 12.10, 0.59, 13.16, 1614930466.010683246, 1614930732.194202054],
    ["SVFit", 1e2, 12.07, 0.50, 13.02, 1614930466.010683246, 1614930732.194202054],
    ["SVFit", 1e2, 12.09, 0.57, 13.21, 1614930466.010683246, 1614930732.194202054],
    ["SVFit", 1e2, 12.08, 0.55, 13.09, 1614930466.010683246, 1614930732.194202054],
    ["SVFit", 1e2, 12.13, 0.52, 13.10, 1614930466.010683246, 1614930732.194202054],
    ["SVFit", 1e2, 12.00, 0.47, 12.94, 1614930466.010683246, 1614930732.194202054],
    ["SVFit", 1e2, 12.00, 0.40, 12.84, 1614930466.010683246, 1614930732.194202054],
    ["SVFit", 1e2, 12.09, 0.51, 13.15, 1614930466.010683246, 1614930732.194202054],
    ["SVFit", 1e2, 13.47, 0.51, 15.00, 1614930466.010683246, 1614930732.194202054],
    ["SVFit", 1e2, 12.10, 0.46, 12.98, 1614930466.010683246, 1614930732.194202054],
    ["DNN", 1e2, 2.88, 1.46, 7.69, 1614930732.199659586, 1614930825.096547979],
    ["DNN", 1e2, 2.54, 1.13, 4.21, 1614930732.199659586, 1614930825.096547979],
    ["DNN", 1e2, 2.58, 1.08, 4.20, 1614930732.199659586, 1614930825.096547979],
    ["DNN", 1e2, 2.59, 1.11, 4.32, 1614930732.199659586, 1614930825.096547979],
    ["DNN", 1e2, 2.49, 1.23, 4.80, 1614930732.199659586, 1614930825.096547979],
    ["DNN", 1e2, 2.56, 1.02, 4.22, 1614930732.199659586, 1614930825.096547979],
    ["DNN", 1e2, 2.47, 1.25, 4.25, 1614930732.199659586, 1614930825.096547979],
    ["DNN", 1e2, 2.61, 1.05, 4.29, 1614930732.199659586, 1614930825.096547979],
    ["DNN", 1e2, 2.34, 1.12, 4.13, 1614930732.199659586, 1614930825.096547979],
    ["DNN", 1e2, 2.42, 1.19, 4.21, 1614930732.199659586, 1614930825.096547979],
    ["DNN", 1e2, 2.32, 1.19, 4.13, 1614930732.199659586, 1614930825.096547979],
    ["DNN", 1e2, 2.32, 1.13, 4.08, 1614930732.199659586, 1614930825.096547979],
    ["DNN", 1e2, 2.44, 1.28, 4.32, 1614930732.199659586, 1614930825.096547979],
    ["DNN", 1e2, 2.39, 1.38, 4.20, 1614930732.199659586, 1614930825.096547979],
    ["DNN", 1e2, 2.72, 1.59, 7.28, 1614930732.199659586, 1614930825.096547979],
    ["DNN", 1e2, 2.46, 1.24, 4.30, 1614930732.199659586, 1614930825.096547979],
    ["DNN", 1e2, 2.51, 1.40, 4.34, 1614930732.199659586, 1614930825.096547979],
    ["DNN", 1e2, 2.42, 1.31, 4.25, 1614930732.199659586, 1614930825.096547979],
    ["DNN", 1e2, 2.70, 1.25, 5.15, 1614930732.199659586, 1614930825.096547979],
    ["DNN", 1e2, 2.37, 1.22, 4.30, 1614930732.199659586, 1614930825.096547979],
    ["SVFit", 1e3, 113.95, 0.57, 60+55.26, 1614930825.103983069, 1614931973.205180649],
    ["SVFit", 1e3, 113.86, 0.64, 60+55.25, 1614930825.103983069, 1614931973.205180649],
    ["SVFit", 1e3, 114.61, 0.52, 60+55.89, 1614930825.103983069, 1614931973.205180649],
    ["SVFit", 1e3, 113.89, 0.67, 60+56.03, 1614930825.103983069, 1614931973.205180649],
    ["SVFit", 1e3, 112.99, 0.68, 60+54.42, 1614930825.103983069, 1614931973.205180649],
    ["SVFit", 1e3, 113.68, 0.62, 60+54.99, 1614930825.103983069, 1614931973.205180649],
    ["SVFit", 1e3, 112.57, 0.64, 60+54.56, 1614930825.103983069, 1614931973.205180649],
    ["SVFit", 1e3, 112.74, 0.60, 60+54.03, 1614930825.103983069, 1614931973.205180649],
    ["SVFit", 1e3, 113.23, 0.69, 60+54.66, 1614930825.103983069, 1614931973.205180649],
    ["SVFit", 1e3, 110.90, 0.69, 60+52.89, 1614930825.103983069, 1614931973.205180649],
    ["DNN", 1e3, 4.55, 1.68, 13.23, 1614931973.210271710, 1614932036.623117186],
    ["DNN", 1e3, 3.38, 1.26, 5.14, 1614931973.210271710, 1614932036.623117186],
    ["DNN", 1e3, 3.65, 1.51, 5.33, 1614931973.210271710, 1614932036.623117186],
    ["DNN", 1e3, 3.87, 1.30, 5.33, 1614931973.210271710, 1614932036.623117186],
    ["DNN", 1e3, 3.77, 1.35, 5.47, 1614931973.210271710, 1614932036.623117186],
    ["DNN", 1e3, 4.04, 1.50, 5.85, 1614931973.210271710, 1614932036.623117186],
    ["DNN", 1e3, 4.03, 1.38, 5.73, 1614931973.210271710, 1614932036.623117186],
    ["DNN", 1e3, 4.08, 1.68, 5.93, 1614931973.210271710, 1614932036.623117186],
    ["DNN", 1e3, 3.61, 1.24, 5.38, 1614931973.210271710, 1614932036.623117186],
    ["DNN", 1e3, 4.01, 1.46, 5.71, 1614931973.210271710, 1614932036.623117186],
    ["SVFit", 1e4, 1112.80, 1.03, 18*60+36.18, 1614932036.630677470, 1614937597.634723468],
    ["SVFit", 1e4, 1115.85, 0.87, 18*60+39.51, 1614932036.630677470, 1614937597.634723468],
    ["SVFit", 1e4, 1102.82, 0.85, 18*60+26.10, 1614932036.630677470, 1614937597.634723468],
    ["SVFit", 1e4, 1099.83, 0.64, 18*60+23.05, 1614932036.630677470, 1614937597.634723468],
    ["SVFit", 1e4, 1112.72, 0.78, 18*60+36.09, 1614932036.630677470, 1614937597.634723468],
    ["DNN", 1e4, 19.46, 3.18, 24.16, 1614937597.639459188, 1614937705.246219159],
    ["DNN", 1e4, 18.28, 2.30, 19.08, 1614937597.639459188, 1614937705.246219159],
    ["DNN", 1e4, 18.61, 2.35, 19.11, 1614937597.639459188, 1614937705.246219159],
    ["DNN", 1e4, 19.17, 2.94, 26.28, 1614937597.639459188, 1614937705.246219159],
    ["DNN", 1e4, 18.18, 2.54, 18.91, 1614937597.639459188, 1614937705.246219159],
    ["SVFit", 1e5, 11035.33, 3.07, 3*60*60+4*60+19, 1614937705.255064871, 1614948764.668226081],
    ["DNN", 1e5, 170.78, 13.55, 2*60+59.95, 1614948764.672342383, 1614948944.638441114],
] 

# format is script, Nevents, user time, system time , wall clock, date start (all iters), date end (all iters), in seconds

Scripts = []
Nevents = []
N_iters = {}
Utimes = {}
Stimes = {}
WCtimes= {}
Dtimes = {}

for info in times:
    s, N, ut, st, wt, ds, de = info[0], info[1], info[2], info[3], info[4], info[5], info[6]
    if s not in Scripts:
        Scripts.append(s)
        Utimes[s] = {}
        Stimes[s] = {}
        WCtimes[s] = {}
        Dtimes[s] = {}
        N_iters[s] = {}
    if N not in Nevents:
        Nevents.append(N)
    if N not in Utimes[s]:
        Utimes[s][N] = 0
        Stimes[s][N] = 0
        WCtimes[s][N] = 0
        N_iters[s][N] = 0
        Dtimes[s][N]  = de - ds
    Utimes[s][N] += ut
    Stimes[s][N] += st
    WCtimes[s][N] += wt
    N_iters[s][N] += 1

colors = {}
for s in Scripts:
    colors[s] = "C{}".format(Scripts.index(s))
    for N in Nevents:
        Utimes[s][N] *= 1./N_iters[s][N]
        Stimes[s][N] *= 1./N_iters[s][N]
        WCtimes[s][N] *= 1./N_iters[s][N]
        N_iters[s][N] *= 1./N_iters[s][N]
        Dtimes[s][N] *= 1./N_iters[s][N]


# Définir le graphique
fig.addgraph(
    'graph1',
    x_label='Number of events',
    y_label='Time spent / Number of events (s)', show_legend=True, legend_on_side=False,
    x_ticks_step = 2,
    x_scaling = 'log', y_scaling = 'log',
)

plots = {}
for s in Scripts:
    plots[s] = lt.ltPlotPts(Nevents, [Dtimes[s][N]/N for N in Nevents], label=s, color=colors[s])
    fig.addplot(plots[s], 'graph1')


# Sauvegarder la figure
fig.save()

fig.save(format='pdf')
