% homedir
\ifdefined\homedir \else {%
\IfFileExists{/home/lucas/texmf/tex/latex/ltstyle/ltstyle.sty}{\def\homedir{/home/lucas}}{}%
\IfFileExists{/home/torterotot/texmf/tex/latex/ltstyle/ltstyle.sty}{\def\homedir{/home/torterotot}}{}%
} \fi

% General
\def\Hs{\higgs}
\def\Hn{\Higgs}
\def\Ha{\HiggsA}
\def\Hp{\Higgsplus}
\def\Hm{\Higgsminus}
\def\Hu{\Higgsup}
\def\Hd{\Higgsdo}

\newcommand {\Lone}{Level-1\xspace} % Level-1 or L1 ?
\newcommand {\Ltwo}{Level-2\xspace}
\newcommand {\Lthree}{Level-3\xspace}

\newcommand{\Lcal}{\ensuremath{\mathcal{L}}}

\def\DeepCSV{\textsc{DeepCSV}}

\newcommand{\SVFIT}{\textsc{SVfit}}

\def\BR{\ensuremath{\mathcal{BR}}}

\newcommand{\HLTpath}{chemin de déclenchement}
\newcommand{\HLTpaths}{chemins de déclenchement}
\newcommand{\HLTPATH}{Chemin de déclenchement}
\newcommand{\HLTPATHS}{Chemins de déclenchement}

% Parties du détecteur
\newcommand{\CMSBarrel}{\emph{Barrel}}
\newcommand{\CMSEndcap}{\emph{Endcap}}
\newcommand{\CMSForward}{\emph{Forward}}

\newcommand{\CMSbarrel}{\emph{barrel}}
\newcommand{\CMSendcap}{\emph{endcap}}
\newcommand{\CMSforward}{\emph{forward}}

\newcommand{\CMSBarrels}{\emph{Barrels}}
\newcommand{\CMSEndcaps}{\emph{Endcaps}}
\newcommand{\CMSForwards}{\emph{Forwards}}

\newcommand{\CMSbarrels}{\emph{barrels}}
\newcommand{\CMSendcaps}{\emph{endcaps}}
\newcommand{\CMSforwards}{\emph{forwards}}

% HTT
\newcommand{\DEEPTAU}{\textsc{DeepTau}}
\newcommand{\ttbar}{\quarkt\antiquarkt}
\newcommand{\mT}{\ensuremath{m_{\mathrm{T}}}}
\newcommand{\mTtot}{\ensuremath{\mT^{\mathrm{tot}}}}
\newcommand{\Dzeta}{\ensuremath{D_\zeta}}
\newcommand{\minv}{\ensuremath{m_{\mathrm{inv}}}}
\newcommand{\muonID}{\emph{muonID}}
\newcommand{\Ndof}{\ensuremath{N_\text{dof}}}
\newcommand{\Nmdhits}{\ensuremath{N^\text{MD}_\text{hits}}}
\newcommand{\Nms}{\ensuremath{N_\text{MS}}}
\newcommand{\Npixelhits}{\ensuremath{N^\text{pixel}_\text{hits}}}
\newcommand{\Ntrkhits}{\ensuremath{N^\text{tracker}_\text{hits}}}
\newcommand{\EleIDMVA}{\emph{electron ID MVA}}
\newcommand{\CutBasedEleID}{\emph{cut-based ID}}
\newcommand{\CutBasedEleIDVeto}{\emph{cut-based veto ID}}
\newcommand{\Nbtag}{\ensuremath{N_\text{\quarkb-tag}}}
\newcommand{\mCutForCategories}{\ensuremath{m_{\tau\tau}}}
\newcommand{\mCutForCategoriesdef}{\mCutForCategories\ est la masse du \emph{dilepton} estimée par \SVFIT~\cite{SVFit_Bianchini_2014}}

\newcommand{\CATnobtag}{\texttt{no-btag}}
\newcommand{\CATbtag}{\texttt{btag}}
\newcommand{\CATlowdz}{\texttt{low-}\Dzeta}
\newcommand{\CATmediumdz}{\texttt{medium-}\Dzeta}
\newcommand{\CAThighdz}{\texttt{high-}\Dzeta}
\newcommand{\CATtightmt}{\texttt{tight-}\mT}
\newcommand{\CATloosemt}{\texttt{loose-}\mT}

\newcommand{\HLTDoubleTau}{\og double \tauh \fg}
\newcommand{\HLTSingleTau}{\og \tauh\ seul \fg}
\newcommand{\HLTSingleMu}{\og muon seul \fg}
\newcommand{\HLTMuTauCross}{\og muon et \tauh \fg}
\newcommand{\HLTSingleEle}{\og électron seul \fg}
\newcommand{\HLTEleTauCross}{\og électron et \tauh \fg}

\newcommand{\HTTplotsdir}{HTT_no_singleTau_trg}
\newcommand{\plotHTTcontrol}[5][\HTTplotsdir]{%
\begin{tikzpicture}%
\clip (0,.1) rectangle (7.76,7.7) ;
\begin{scope}
\clip (.42,.55) -- (.42,8) -- (1,8) -- (1,7.1) -- (7.76,7.1) -- (7.76,.55) -- cycle ;
\node[anchor=south west,inner sep=0] at (0,0) {\includegraphics[width=7.85cm]{\PhDthesisdir/plots_and_images/my_plots/#1/control_plots/Run#2_plots_#3/#4/Run#2_#4_#5.pdf}};
\end{scope}

% channel
\def\localLA{\ensuremath{\tauh^{(1)}}}
\def\localLB{\ensuremath{\tauh^{(2)}}}
\def\localchannel{\tauh\tauh}
\ifthenelse{\equal{#4}{mt}}{\def\localchannel{\mu\tauh}\def\localLA{\mu}}{}
\ifthenelse{\equal{#4}{et}}{\def\localchannel{\ele\tauh}\def\localLA{\ele}}{}
\ifthenelse{\equal{#4}{em}}{\def\localchannel{\ele\mu}\def\localLA{\ele}\def\localLB{\mu}}{}
\draw (1, 7) node [above right] {\scriptsize \localchannel\ inclusif};

% year
\ifthenelse{\equal{#2}{2016}}{\def\locallumivalue{35.9}}{}
\ifthenelse{\equal{#2}{2017}}{\def\locallumivalue{41.5}}{}
\ifthenelse{\equal{#2}{2018}}{\def\locallumivalue{59.7}}{}
\draw (7.7, 7) node [above left] {\scriptsize \SI{\locallumivalue}{\femto\barn^{-1}} (#2, \SI{13}{\TeV})};

% axis labels
\def\localxaxislabel{\todo{\inlinecode{bash}{#5}}}
\def\localyaxislabel{\todo{Y?}}
\ifthenelse{\equal{#5}{bpt_1}}{
  \def\localxaxislabel{$\pT (\text{\quarkb-jet principal})$ (\SI{}{\GeV})}
  \def\localyaxislabel{Nombre d'événements / $\dd\pT$ (1/\SI{}{\GeV})}
}{}
\ifthenelse{\equal{#5}{bpt_2}}{
  \def\localxaxislabel{$\pT (\text{\quarkb-jet secondaire})$ (\SI{}{\GeV})}
  \def\localyaxislabel{Nombre d'événements / $\dd\pT$ (1/\SI{}{\GeV})}
}{}
\ifthenelse{\equal{#5}{jpt_1}}{
  \def\localxaxislabel{$\pT (\text{jet principal})$ (\SI{}{\GeV})}
  \def\localyaxislabel{Nombre d'événements / $\dd\pT$ (1/\SI{}{\GeV})}
}{}
\ifthenelse{\equal{#5}{jpt_2}}{
  \def\localxaxislabel{$\pT (\text{jet secondaire})$ (\SI{}{\GeV})}
  \def\localyaxislabel{Nombre d'événements / $\dd\pT$ (1/\SI{}{\GeV})}
}{}
\ifthenelse{\equal{#5}{jeta_1}}{
  \def\localxaxislabel{$\eta (\text{jet principal})$}
  \def\localyaxislabel{Nombre d'événements / $\dd\eta$}
}{}
\ifthenelse{\equal{#5}{jeta_2}}{
  \def\localxaxislabel{$\eta (\text{jet secondaire})$}
  \def\localyaxislabel{Nombre d'événements / $\dd\eta$}
}{}
\ifthenelse{\equal{#5}{nbtag}}{
  \def\localxaxislabel{Nombre de \quarkb-jets}
  \def\localyaxislabel{Nombre d'événements}
}{}
\ifthenelse{\equal{#5}{njets}}{
  \def\localxaxislabel{Nombre de jets}
  \def\localyaxislabel{Nombre d'événements}
}{}
\ifthenelse{\equal{#5}{dijetpt}}{
  \def\localxaxislabel{$\pT (\text{2 jets principaux})$ (\SI{}{\GeV})}
  \def\localyaxislabel{Nombre d'événements / $\dd\pT$ (1/\SI{}{\GeV})}
}{}
\ifthenelse{\equal{#5}{jdeta}}{
  \def\localxaxislabel{$\Delta\eta$}
  \def\localyaxislabel{Nombre d'événements / $\dd(\Delta\eta)$}
}{}
\ifthenelse{\equal{#5}{mjj}}{
  \def\localxaxislabel{$\minv (\text{2 jets principaux})$ (\SI{}{\GeV})}
  \def\localyaxislabel{Nombre d'événements / $\dd m$ (1/\SI{}{\GeV})}
}{}
\ifthenelse{\equal{#5}{pt_1}}{
  \def\localxaxislabel{$\pT(\localLA)$ (\SI{}{\GeV})}
  \def\localyaxislabel{Nombre d'événements / $\dd\pT$ (1/\SI{}{\GeV})}
}{}
\ifthenelse{\equal{#5}{pt_2}}{
  \def\localxaxislabel{$\pT(\localLB)$ (\SI{}{\GeV})}
  \def\localyaxislabel{Nombre d'événements / $\dd\pT$ (1/\SI{}{\GeV})}
}{}
\ifthenelse{\equal{#5}{eta_1}}{
  \def\localxaxislabel{$\eta (\localLA)$}
  \def\localyaxislabel{Nombre d'événements / $\dd\eta$}
}{}
\ifthenelse{\equal{#5}{eta_2}}{
  \def\localxaxislabel{$\eta (\localLB)$}
  \def\localyaxislabel{Nombre d'événements / $\dd\eta$}
}{}
\ifthenelse{\equal{#5}{mt_1_puppi}}{
  \def\localxaxislabel{$\mT(\localLA,\MET)$ (\SI{}{\GeV})}
  \def\localyaxislabel{Nombre d'événements / $\dd\mT$ (1/\SI{}{\GeV})}
}{}
\ifthenelse{\equal{#5}{mt_2_puppi}}{
  \def\localxaxislabel{$\mT(\localLB,\MET)$ (\SI{}{\GeV})}
  \def\localyaxislabel{Nombre d'événements / $\dd\mT$ (1/\SI{}{\GeV})}
}{}
\ifthenelse{\equal{#5}{mTdileptonMET_puppi}}{
  \def\localxaxislabel{$\mT(\localLA+\localLB,\MET)$ (\SI{}{\GeV})}
  \def\localyaxislabel{Nombre d'événements / $\dd\mT$ (1/\SI{}{\GeV})}
}{}
\ifthenelse{\equal{#5}{pZetaPuppiMissVis}}{
  \def\localxaxislabel{$\Dzeta$ (\SI{}{\GeV})}
  \def\localyaxislabel{Nombre d'événements / $\dd\Dzeta$ (1/\SI{}{\GeV})}
}{}
\ifthenelse{\equal{#5}{pt_tt_puppi}}{
  \def\localxaxislabel{$\pT (\tau\tau)$ (\SI{}{\GeV})}
  \def\localyaxislabel{Nombre d'événements / $\dd\pT$ (1/\SI{}{\GeV})}
}{}
\ifthenelse{\equal{#5}{DiTauDeltaR}}{
  \def\localxaxislabel{$\Delta R (\localLA,\localLB)$}
  \def\localyaxislabel{Nombre d'événements / $\dd(\Delta R)$}
}{}
\ifthenelse{\equal{#5}{m_sv_puppi}}{
  \def\localxaxislabel{$m (\tau\tau, \text{\SVFIT})$ (\SI{}{\GeV})}
  \def\localyaxislabel{Nombre d'événements / $\dd m$ (1/\SI{}{\GeV})}
}{}
\ifthenelse{\equal{#5}{puppimet}}{
  \def\localxaxislabel{$\MET$ (\SI{}{\GeV})}
  \def\localyaxislabel{Nombre d'événements / $\dd \MET$ (1/\SI{}{\GeV})}
}{}
\ifthenelse{\equal{#5}{m_vis}}{
  \def\localxaxislabel{$m (\tau\tau, \text{visible})$ (\SI{}{\GeV})}
  \def\localyaxislabel{Nombre d'événements / $\dd m$ (1/\SI{}{\GeV})}
}{}
\ifthenelse{\equal{#5}{ptvis}}{
  \def\localxaxislabel{$\pT (\text{\emph{dilepton}})$ (\SI{}{\GeV})}
  \def\localyaxislabel{Nombre d'événements / $\dd \pT$ (1/\SI{}{\GeV})}
}{}
\draw (7.7, 0) node [above left] {\footnotesize \localxaxislabel};
\draw (-.1, 7.2) node [below left, rotate=90] {\footnotesize \localyaxislabel};

% CMS disclaimer
\draw (1.85, 6.5) node [above] {\scriptsize CMS Data};
\draw (1.85, 6.5) node [below, text width=1cm] {\centering\scriptsize \WorkInProgress\par};
\end{tikzpicture}%
}

\newcommand{\plotHTTcontrolCATmt}[4][\HTTplotsdir]{%
\begin{tikzpicture}%
\node[anchor=south west] at (0,0) {\plotHTTcontrol[#1]{#2}{#3}{#4}{mt_1_puppi}};

\foreach \x in {40, 70}{
 \draw [thick, dashed] ({1.25 + (\x-0)/(160-0)*(7.68-1.25)}, 2.8) --+ (0, 5.6-2.8);
 \draw [thick, dashed] ({1.25 + (\x-0)/(160-0)*(7.68-1.25)}, 0.95) --+ (0, 2.2-0.95);
}

\draw ({1.25 + (20-0)/(160-0)*(7.68-1.25)}, 5.6) node [below] {\tiny \CATtightmt};
\draw ({1.25 + (55-0)/(160-0)*(7.68-1.25)}, 5.6) node [below] {\tiny \CATloosemt};
\draw ({1.25 + (115-0)/(160-0)*(7.68-1.25)}, 5.6) node [below] {\tiny DR $\Wboson+\text{jets}$};
\end{tikzpicture}%
}

\newcommand{\plotHTTcontrolCATdz}[4][\HTTplotsdir]{%
\begin{tikzpicture}%
\node[anchor=south west] at (0,0) {\plotHTTcontrol[#1]{#2}{#3}{#4}{pZetaPuppiMissVis}};

\foreach \x in {-35, -10, 30}{
 \draw [thick, dashed] ({1.25 + (\x+200)/(200+200)*(7.68-1.25)}, 2.8) --+ (0, 5.6-2.8);
 \draw [thick, dashed] ({1.25 + (\x+200)/(200+200)*(7.68-1.25)}, 0.95) --+ (0, 2.2-0.95);
}

\draw ({1.25 + (-117.5+200)/(200+200)*(7.68-1.25)}, 5.6) node [below] {\tiny CR \ttbar};
\draw ({1.25 + (-22.5+200)/(200+200)*(7.68-1.25)}, 5.6) node [left, rotate=90] {\tiny \CATlowdz};
\draw ({1.25 + (20+200)/(200+200)*(7.68-1.25)}, 5.6) node [left, rotate=90] {\tiny \CATmediumdz};
\draw ({1.25 + (115+200)/(200+200)*(7.68-1.25)}, 5.6) node [below] {\tiny \CAThighdz};
\end{tikzpicture}%
}

% JERC
\newcommand{\Rbal}{{\ensuremath{R_{\mathit{bal}}}}}
\newcommand{\RMPF}{{\ensuremath{R_{\mathit{MPF}}}}}
\newcommand{\kT}{{\ensuremath{k_{\mathrm{T}}}}}

\newcommand{\ptcl}{{\text{\rm ptcl}}}
\newcommand{\reco}{{\text{\rm reco}}}
\newcommand{\cali}{{\text{\rm corr}}}

\newcommand{\Gjet}{$\photon+\text{jet}$}
\newcommand{\Gjets}{$\photon+\text{jets}$}
\newcommand{\Zjet}{$\Zboson+\text{jet}$}
\newcommand{\Zjets}{$\Zboson+\text{jets}$}
\newcommand{\Zeejet}{$\Zboson(\to\antielectron\electron)+\text{jet}$}
\newcommand{\Zeejets}{$\Zboson(\to\antielectron\electron)+\text{jets}$}
\newcommand{\Zmmjet}{$\Zboson(\to\antimuon\muon)+\text{jet}$}
\newcommand{\Zmmjets}{$\Zboson(\to\antimuon\muon)+\text{jets}$}

% CMS disclaimers
\newcommand{\OwnWork}{\emph{Own work}}
\newcommand{\WorkInProgress}{\emph{Work in progress}}