% homedir
\ifdefined\homedir \else {%
\IfFileExists{/home/lucas/texmf/tex/latex/ltstyle/ltstyle.sty}{\def\homedir{/home/lucas}}{}%
\IfFileExists{/home/torterotot/texmf/tex/latex/ltstyle/ltstyle.sty}{\def\homedir{/home/torterotot}}{}%
} \fi

% General
\def\NordreNNT{\todo{?}}
\def\LYCEN{\todo{?}}

\def\Hs{\higgs}
\def\Hn{\Higgs}
\def\Ha{\HiggsA}
\def\Hp{\Higgsplus}
\def\Hm{\Higgsminus}
\def\Hu{\Higgsup}
\def\Hd{\Higgsdo}

\newcommand{\higgsSM}{\ensuremath{\higgs_\text{SM}}}
\newcommand{\higgsMSSM}{\ensuremath{\higgs_\text{MSSM}}}
\newcommand{\higgsML}{\ensuremath{\mathcal{H}}}

\newcommand{\SM}{SM}%{modèle standard}

\newcommand {\Lone}{Level-1\xspace} % Level-1 or L1 ?
\newcommand {\Ltwo}{Level-2\xspace}
\newcommand {\Lthree}{Level-3\xspace}

\newcommand{\Lcal}{\ensuremath{\mathcal{L}}}
\newcommand{\LKH}{\ensuremath{\mathfrak{L}}}
\newcommand{\Poisson}{\ensuremath{\mathfrak{P}}}
\newcommand{\Constraint}{\ensuremath{\mathfrak{C}}}
\newcommand{\hypB}{\ensuremath{\mathfrak{b}}}
\newcommand{\hypSB}{\ensuremath{\mathfrak{sb}}}
\newcommand{\hypS}{\ensuremath{\mathfrak{s}}}
\newcommand{\hypH}{\ensuremath{\mathfrak{h}}}
\newcommand{\CLB}{\ensuremath{CL_{\hypB}}}
\newcommand{\CLSB}{\ensuremath{CL_{\hypSB}}}
\newcommand{\CLS}{\ensuremath{CL_{\hypS}}}

\newcommand{\POG}{\emph{POG}}
\newcommand{\PAG}{\emph{PAG}}

\def\DeepCSV{\textsc{DeepCSV}}

\newcommand{\SVFIT}{\textsc{SVfit}}

\def\BR{\ensuremath{\mathcal{BR}}}

\newcommand{\HLTpath}{chemin de déclenchement}
\newcommand{\HLTpaths}{chemins de déclenchement}
\newcommand{\HLTPATH}{Chemin de déclenchement}
\newcommand{\HLTPATHS}{Chemins de déclenchement}

\newcommand{\fakefactor}{facteur de faux}
\newcommand{\fakefactors}{facteurs de faux}
\newcommand{\Fakefactor}{Facteur de faux}
\newcommand{\Fakefactors}{Facteurs de faux}

\newcommand{\refChMSSM}{\ifref{chapter-MS-MSSM}{\ref{chapter-MS-MSSM}}{1}}
\newcommand{\refChLHCCMS}{\ifref{chapter-LHC}{\ref{chapter-LHC}}{2}}
\newcommand{\refChJERC}{\ifref{chapter-JERC}{\ref{chapter-JERC}}{3}}
\newcommand{\refChHTT}{\ifref{chapter-HTT_analysis}{\ref{chapter-HTT_analysis}}{4}}
\newcommand{\refChML}{\ifref{chapter-ML}{\ref{chapter-ML}}{5}}


\newcommand{\refApHTTctrlplotsLETTER}{G}
\newcommand{\refApHTTshapesLETTER}{H}

\newcommand{\refApUNSI}{\ifref{annexe-SI_UN}{\ref{annexe-SI_UN}}{A}}
\newcommand{\refApMath}{\ifref{annexe-maths}{\ref{annexe-maths}}{B}}
\newcommand{\refApFmf}{\ifref{annexe-fmf}{\ref{annexe-fmf}}{C}}
\newcommand{\refApJERCdatasets}{\ifref{annexe-datasets-GJets}{\ref{annexe-datasets-GJets}}{D}}
\newcommand{\refApHTTdatasets}{\ifref{annexe-datasets-HTT}{\ref{annexe-datasets-HTT}}{E}}
\newcommand{\refApHTTtrg}{\ifref{annexe-triggers-HTT}{\ref{annexe-triggers-HTT}}{F}}
\newcommand{\refApHTTctrlplots}{\ifref{annexe-control_plots-HTT}{\ref{annexe-control_plots-HTT}}{\refApHTTctrlplotsLETTER}}
\newcommand{\refApHTTshapes}{\ifref{annexe-discriminating_variables-HTT}{\ref{annexe-discriminating_variables-HTT}}{\refApHTTshapesLETTER}}

% Parties du détecteur
\newcommand{\CMSBarrel}{\emph{Barrel}}
\newcommand{\CMSEndcap}{\emph{Endcap}}
\newcommand{\CMSForward}{\emph{Forward}}

\newcommand{\CMSbarrel}{\emph{barrel}}
\newcommand{\CMSendcap}{\emph{endcap}}
\newcommand{\CMSforward}{\emph{forward}}

\newcommand{\CMSBarrels}{\emph{Barrels}}
\newcommand{\CMSEndcaps}{\emph{Endcaps}}
\newcommand{\CMSForwards}{\emph{Forwards}}

\newcommand{\CMSbarrels}{\emph{barrels}}
\newcommand{\CMSendcaps}{\emph{endcaps}}
\newcommand{\CMSforwards}{\emph{forwards}}

\renewcommand{\CMSBarrel}{Tonneau}
\renewcommand{\CMSEndcap}{Bouchon}
\renewcommand{\CMSForward}{Vers l'avant}

\renewcommand{\CMSbarrel}{tonneau}
\renewcommand{\CMSendcap}{bouchon}
\renewcommand{\CMSforward}{vers l'avant}

\renewcommand{\CMSBarrels}{Tonneaux}
\renewcommand{\CMSEndcaps}{Bouchons}
\renewcommand{\CMSForwards}{\CMSForward}

\renewcommand{\CMSbarrels}{tonneaux}
\renewcommand{\CMSendcaps}{bouchons}
\renewcommand{\CMSforwards}{\CMSforward}

% HTT
\newcommand{\DEEPTAU}{\textsc{DeepTau}}
\newcommand{\ttbar}{\quarkt\antiquarkt}
\newcommand{\Wjet}{\ensuremath{\Wboson+\text{jet}}}
\newcommand{\Wjets}{\ensuremath{\Wboson+\text{jets}}}
\newcommand{\mT}{\ensuremath{m_{\mathrm{T}}}}
\newcommand{\mTtot}{\ensuremath{\mT^{\mathrm{tot}}}}
\newcommand{\msv}{\ensuremath{m_{\SVFIT}}}
\newcommand{\mlmass}{\ensuremath{m_{\mathrm{ML}}}}
\newcommand{\mml}{\mlmass}
\newcommand{\mtt}{\ensuremath{m^{(\tau\tau)}}}
\newcommand{\mvis}{\mtt}
\newcommand{\pTvis}{\ensuremath{\pT^{(\tau\tau)}}}
\newcommand{\vpTvis}{\ensuremath{\vpT^{(\tau\tau)}}}
\newcommand{\Dzeta}{\ensuremath{D_\zeta}}
\newcommand{\minv}{\ensuremath{m_{\mathrm{inv}}}}
\newcommand{\muonID}{\emph{muonID}}
\newcommand{\Njets}{\ensuremath{N_{\textrm{jets}}}}
\newcommand{\Nbjets}{\ensuremath{N_{\textrm{\quarkb-jets}}}}
\newcommand{\Nprebjets}{\ensuremath{N_{\textrm{pre \quarkb-jets}}}}
\newcommand{\mjj}{\ensuremath{m_{\mathrm{jj}}}}
\newcommand{\Detajj}{\ensuremath{\Delta \eta_{\mathrm{jj}}}}
\newcommand{\Ndof}{\ensuremath{N_{\textrm{dof}}}}
\newcommand{\Nmdhits}{\ensuremath{N^{\textrm{MD}}_{\textrm{hits}}}}
\newcommand{\Nms}{\ensuremath{N_{\textrm{MS}}}}
\newcommand{\Npixelhits}{\ensuremath{N^{\textrm{pixel}}_{\textrm{hits}}}}
\newcommand{\Ntrkhits}{\ensuremath{N^{\textrm{tracker}}_{\textrm{hits}}}}
\newcommand{\EleIDMVA}{\emph{electron ID MVA}}
\newcommand{\ELEIDMVA}{\emph{Electron ID MVA}}
\newcommand{\CutBasedEleID}{\emph{cut-based ID}}
\newcommand{\CUTBASEDELEID}{\emph{Cut-based ID}}
\newcommand{\CutBasedEleIDVeto}{\emph{cut-based veto ID}}
\newcommand{\CUTBASEDELEIDVETO}{\emph{Cut-based veto ID}}
\newcommand{\Nbtag}{\Nbjets}
\newcommand{\mCutForCategories}{\msv}
\newcommand{\mCutForCategoriesdef}{\mCutForCategories\ est la masse du dilepton estimée par \SVFIT~\cite{SVFit_Bianchini_2014}}

\newcommand{\ftauh}{\text{faux~\tauh}}
\newcommand{\ftauhs}{\text{faux~\tauh}}

\newcommand{\FF}{\ensuremath{\mathrm{FF}}}

\newcommand{\GetChannelStr}[1]{%
\ifthenelse{\equal{#1}{tt}}{\tauh\tauh}{}%
\ifthenelse{\equal{#1}{mt}}{\mu\tauh}{}%
\ifthenelse{\equal{#1}{et}}{\ele\tauh}{}%
\ifthenelse{\equal{#1}{mm}}{\mu\mu}{}%
\ifthenelse{\equal{#1}{em}}{\ele\mu}{}%
\ifthenelse{\equal{#1}{ee}}{\ele\ele}{}%
\ifthenelse{\equal{#1}{lt}}{$\ell\tauh$}{}%
\ifthenelse{\equal{#1}{ll}}{$\ell\ell$}{}%
}

\newcommand{\CATnobtag}{\texttt{no-btag}}
\newcommand{\CATbtag}{\texttt{btag}}
\newcommand{\CATlowdz}{\texttt{low-}\Dzeta}
\newcommand{\CATmediumdz}{\texttt{medium-}\Dzeta}
\newcommand{\CAThighdz}{\texttt{high-}\Dzeta}
\newcommand{\CATtightmt}{\texttt{tight-}\mT}
\newcommand{\CATloosemt}{\texttt{loose-}\mT}

\newcommand{\NNscore}{\ensuremath{\mathrm{NN}_{\mathrm{score}}}}

\newcommand{\CATxxh}{\texttt{xxh}}
\newcommand{\CATemb}{\texttt{emb}}
\newcommand{\CATzll}{\texttt{zll}}
\newcommand{\CATttbar}{\texttt{ttbar}}
\newcommand{\CATdib}{\texttt{diboson}}
\newcommand{\CATfake}{\texttt{fake}}
\newcommand{\CATqcd}{\texttt{qcd}}
\newcommand{\CATmisc}{\texttt{misc}}

\newcommand{\CATttbarctrl}{CR \ttbar}

\newcommand{\CATbsm}{\texttt{BSM}}
\newcommand{\CATsm}{\texttt{SM}}

\newcommand{\HLTDoubleTau}{\og double \tauh \fg}
\newcommand{\HLTDoubleMu}{\og double muon \fg}
\newcommand{\HLTSingleTau}{\og \tauh\ seul \fg}
\newcommand{\HLTSingleMu}{\og muon seul \fg}
\newcommand{\HLTMuTauCross}{\og muon et \tauh \fg}
\newcommand{\HLTSingleEle}{\og électron seul \fg}
\newcommand{\HLTEleTauCross}{\og électron et \tauh \fg}

\newcommand{\nfpCLlimit}{\CLS\ à \SI{95}{\%}}
\newcommand{\nfpCLlimitON}{\nfpCLlimit\ sur}

\newcommand{\Neventsaxis}{Événements}
\newcommand{\InclusiveSTR}{inclusif}

\newcommand{\RatiosaxisA}{Rapport au}
\newcommand{\RatiosaxisB}{bruit de fond}

\newcommand{\HTTplotsdir}{HTT_v2}

\newcommand{\GETplotHTTModelIndepLimitsINFOS}[5][\HTTplotsdir]{%

\def\localyaxislabelXXH{\todo{?}}
\ifthenelse{\equal{#4}{ggH}}{
  \def\localyaxislabelXXH{\ensuremath{\gluon\gluon\Phi}}
}{}
\ifthenelse{\equal{#4}{bbH}}{
  \def\localyaxislabelXXH{\ensuremath{\quarkb\antiquarkb\Phi}}
}{}

\def\localxaxislabel{$m_\Phi$ (\SI{}{\GeV})}
\def\localyaxislabel{\nfpCLlimitON\ $\sigma(\localyaxislabelXXH) \times \BR(\Phi\to\tau\tau)$ (\SI{}{\pico\barn})}

% year
\def\locallumivalue{137}\def\localera{Run II}
\ifthenelse{\equal{#3}{2016}}{\def\locallumivalue{35.9}\def\localera{2016}}{}
\ifthenelse{\equal{#3}{2017}}{\def\locallumivalue{41.5}\def\localera{2017}}{}
\ifthenelse{\equal{#3}{2018}}{\def\locallumivalue{59.7}\def\localera{2018}}{}

}

\newcommand{\plotHTTModelIndepLimits}[5][\HTTplotsdir]{%
\begin{tikzpicture}%
\begin{scope}
\clip (.7,.55) -- (.7,7.3) -- (1.25,7.3) -- (1.25,7.11) -- (7.6,7.11) -- (7.6,.55) -- cycle ;
\node[anchor=south west,inner sep=0] at (0,0) {\includegraphics[width=7.85cm]{\PhDthesisdir/plots_and_images/my_plots/#1/limits/#2/mssm_model-independent_#3_#4#5.pdf}};
\fill [white] (1.5, 6) rectangle (3.6, 7);
\end{scope}

\GETplotHTTModelIndepLimitsINFOS[#1]{#2}{#3}{#4}{#5}

\draw (7.7, 0) node [above left] {\footnotesize \localxaxislabel\vphantom{Àq,}};
\draw (0, 7.2) node [below left, rotate=90] {\footnotesize \localyaxislabel\vphantom{Àq,}};
\draw (7.7, 7) node [above left] {\scriptsize \SI{\locallumivalue}{\femto\barn^{-1}} (\localera, \SI{13}{\TeV})\vphantom{Àq,}};

% CMS disclaimer
\draw (1.15, 7) node [above right] {\scriptsize CMS Data\vphantom{Àq,}};
\draw (2.35, 6.75) node [below, text width=1cm] {\centering\scriptsize \WorkInProgress\par};
\end{tikzpicture}%
}

\newcommand{\GETplotHTTModelDepLimitsINFOS}[3][\HTTplotsdir]{%

\def\localxaxislabelptc{\HiggsA}
\ifthenelse{\equal{#2}{mssm_vs_sm_CPV}\or\equal{#2}{mssm_vs_sm_CPV-new_categories}}{
  \def\localxaxislabelptc{\Higgspm}
}{}

\def\localxaxislabel{$m_{\localxaxislabelptc}$ (\SI{}{\GeV})}
\def\localyaxislabel{$\tan\beta$}

}

\newcommand{\plotHTTModelDepLimits}[3][\HTTplotsdir]{%
\begin{tikzpicture}%
\begin{scope}
\clip (.5,.55) -- (.5,7.11) -- (7.675,7.11) -- (7.675,.55) -- cycle ;
\node[anchor=south west,inner sep=0] at (0,0) {\includegraphics[width=7.85cm]{\PhDthesisdir/plots_and_images/my_plots/#1/limits/#2/mssm_mh125_#2#3.pdf}};
\end{scope}

\GETplotHTTModelDepLimitsINFOS[#1]{#2}{#3}

\draw (7.5, 0) node [above left] {\footnotesize \localxaxislabel\vphantom{Àq,}};
\draw (0, 6.2) node [below left, rotate=90] {\footnotesize \localyaxislabel\vphantom{Àq,}};

% year
\draw (7.55, 7) node [above left] {\scriptsize \SI{137}{\femto\barn^{-1}} (Run II, \SI{13}{\TeV})\vphantom{Àq,}};

% CMS disclaimer
\draw (.8, 7) node [above right] {\scriptsize CMS Data\vphantom{Àq,}};
\draw (2.35, 7) node [below, text width=1cm] {\centering\scriptsize \WorkInProgress\par};
\end{tikzpicture}%
}

\newcommand{\GETplotHTTcontrolINFO}[5][\HTTplotsdir]{%

% cuts
\def\localcat{\InclusiveSTR{}}
\ifthenelse{\equal{#3}{emb_ff_high_ml_mass}}{\def\localcat{$\mml>\SI{250}{\GeV}$}}{}
\ifthenelse{\equal{#3}{emb_ff_high_m_sv_puppi}}{\def\localcat{$\msv>\SI{250}{\GeV}$}}{}

% channel
\ifthenelse{\equal{#4}{tt}}{\def\localchannel{\tauh\tauh}\def\localLA{\ensuremath{\tauh^{(1)}}}\def\localLB{\ensuremath{\tauh^{(2)}}}}{}
\ifthenelse{\equal{#4}{mt}}{\def\localchannel{\mu\tauh}\def\localLA{\mu}\def\localLB{\ensuremath{\tauh}}}{}
\ifthenelse{\equal{#4}{et}}{\def\localchannel{\ele\tauh}\def\localLA{\ele}\def\localLB{\ensuremath{\tauh}}}{}
\ifthenelse{\equal{#4}{em}}{\def\localchannel{\ele\mu}\def\localLA{\ele}\def\localLB{\mu}}{}

% year
\ifthenelse{\equal{#2}{2016}}{\def\locallumivalue{35.9}}{}
\ifthenelse{\equal{#2}{2017}}{\def\locallumivalue{41.5}}{}
\ifthenelse{\equal{#2}{2018}}{\def\locallumivalue{59.7}}{}

% axis labels
\def\localxaxislabel{\todo{\inlinecode{bash}{#5}}}
\def\localyaxislabel{\todo{Y?}}
\ifthenelse{\equal{#5}{bpt_1}}{
  \def\localxaxislabel{$\pT (\text{\quarkb-jet principal})$ (\SI{}{\GeV})}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\pT}$ (\SI{}{\GeV^{-1}})}
}{}
\ifthenelse{\equal{#5}{bpt_2}}{
  \def\localxaxislabel{$\pT (\text{\quarkb-jet secondaire})$ (\SI{}{\GeV})}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\pT}$ (\SI{}{\GeV^{-1}})}
}{}
\ifthenelse{\equal{#5}{jpt_1}}{
  \def\localxaxislabel{$\pT (\text{jet principal})$ (\SI{}{\GeV})}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\pT}$ (\SI{}{\GeV^{-1}})}
}{}
\ifthenelse{\equal{#5}{jpt_2}}{
  \def\localxaxislabel{$\pT (\text{jet secondaire})$ (\SI{}{\GeV})}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\pT}$ (\SI{}{\GeV^{-1}})}
}{}
\ifthenelse{\equal{#5}{jpt_r}}{
  \def\localxaxislabel{$\pT (\text{activité hadronique additionnelle})$ (\SI{}{\GeV})}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\pT}$ (\SI{}{\GeV^{-1}})}
}{}
\ifthenelse{\equal{#5}{jeta_1}}{
  \def\localxaxislabel{$\eta (\text{jet principal})$}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\eta}$}
}{}
\ifthenelse{\equal{#5}{jeta_2}}{
  \def\localxaxislabel{$\eta (\text{jet secondaire})$}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\eta}$}
}{}
\ifthenelse{\equal{#5}{jeta_r}}{
  \def\localxaxislabel{$\eta (\text{activité hadronique additionnelle})$}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\eta}$}
}{}
\ifthenelse{\equal{#5}{jphi_1}}{
  \def\localxaxislabel{$\phi (\text{jet principal})$}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\phi}$}
}{}
\ifthenelse{\equal{#5}{jphi_2}}{
  \def\localxaxislabel{$\phi (\text{jet secondaire})$}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\phi}$}
}{}
\ifthenelse{\equal{#5}{jphi_r}}{
  \def\localxaxislabel{$\phi (\text{activité hadronique additionnelle})$}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\phi}$}
}{}
\ifthenelse{\equal{#5}{nbtag}}{
  \def\localxaxislabel{\Nbjets}
  \def\localyaxislabel{\Neventsaxis}
}{}
\ifthenelse{\equal{#5}{njets}}{
  \def\localxaxislabel{\Njets}
  \def\localyaxislabel{\Neventsaxis}
}{}
\ifthenelse{\equal{#5}{Njet_r}}{
  \def\localxaxislabel{\Njetsr}
  \def\localyaxislabel{\Neventsaxis}
}{}
\ifthenelse{\equal{#5}{npv}}{
  \def\localxaxislabel{\Npu}
  \def\localyaxislabel{\Neventsaxis}
}{}
\ifthenelse{\equal{#5}{dijetpt}}{
  \def\localxaxislabel{$\pT (\text{2 jets principaux})$ (\SI{}{\GeV})}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\pT}$ (\SI{}{\GeV^{-1}})}
}{}
\ifthenelse{\equal{#5}{jdeta}}{
  \def\localxaxislabel{$\Detajj (\text{2 jets principaux})$}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\Detajj}$}
}{}
\ifthenelse{\equal{#5}{mjj}}{
  \def\localxaxislabel{$\mjj (\text{2 jets principaux})$ (\SI{}{\GeV})}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{m}$ (\SI{}{\GeV^{-1}})}
}{}
\ifthenelse{\equal{#5}{pt_1}}{
  \def\localxaxislabel{$\pT(\localLA)$ (\SI{}{\GeV})}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\pT}$ (\SI{}{\GeV^{-1}})}
}{}
\ifthenelse{\equal{#5}{pt_2}}{
  \def\localxaxislabel{$\pT(\localLB)$ (\SI{}{\GeV})}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\pT}$ (\SI{}{\GeV^{-1}})}
}{}
\ifthenelse{\equal{#5}{eta_1}}{
  \def\localxaxislabel{$\eta (\localLA)$}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\eta}$}
}{}
\ifthenelse{\equal{#5}{eta_2}}{
  \def\localxaxislabel{$\eta (\localLB)$}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\eta}$}
}{}
\ifthenelse{\equal{#5}{phi_1}}{
  \def\localxaxislabel{$\phi (\localLA)$}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\phi}$}
}{}
\ifthenelse{\equal{#5}{phi_2}}{
  \def\localxaxislabel{$\phi (\localLB)$}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\phi}$}
}{}
\ifthenelse{\equal{#5}{mt_1_puppi}}{
  \def\localxaxislabel{$\mT(\localLA,\MET)$ (\SI{}{\GeV})}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\mT}$ (\SI{}{\GeV^{-1}})}
}{}
\ifthenelse{\equal{#5}{mt_2_puppi}}{
  \def\localxaxislabel{$\mT(\localLB,\MET)$ (\SI{}{\GeV})}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\mT}$ (\SI{}{\GeV^{-1}})}
}{}
\ifthenelse{\equal{#5}{mTdileptonMET_puppi}}{
  \def\localxaxislabel{$\mT(\localLA+\localLB,\MET)$ (\SI{}{\GeV})}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\mT}$ (\SI{}{\GeV^{-1}})}
}{}
\ifthenelse{\equal{#5}{pZetaPuppiMissVis}}{
  \def\localxaxislabel{$\Dzeta$ (\SI{}{\GeV})}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\Dzeta}$ (\SI{}{\GeV^{-1}})}
}{}
\ifthenelse{\equal{#5}{pt_tt_puppi}}{
  \def\localxaxislabel{$\pT (\localLA+\localLB+\MET)$ (\SI{}{\GeV})}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\pT}$ (\SI{}{\GeV^{-1}})}
}{}
\ifthenelse{\equal{#5}{DiTauDeltaR}}{
  \def\localxaxislabel{$\Delta R (\localLA,\localLB)$}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\Delta R}$}
}{}
\ifthenelse{\equal{#5}{m_sv_puppi}}{
  \def\localxaxislabel{$\msv$ (\SI{}{\GeV})}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{m}$ (\SI{}{\GeV^{-1}})}
}{}
\ifthenelse{\equal{#5}{puppimet}}{
  \def\localxaxislabel{$\MET$ (\SI{}{\GeV})}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\MET}$ (\SI{}{\GeV^{-1}})}
}{}
\ifthenelse{\equal{#5}{puppimetphi}}{
  \def\localxaxislabel{$\phi(\MET)$}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\phi}$}
}{}
\ifthenelse{\equal{#5}{m_vis}}{
  \def\localxaxislabel{$\mvis$ (\SI{}{\GeV})}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{m}$ (\SI{}{\GeV^{-1}})}
}{}
\ifthenelse{\equal{#5}{ptvis}}{
  \def\localxaxislabel{$\pTvis$ (\SI{}{\GeV})}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\pT}$ (\SI{}{\GeV^{-1}})}
}{}
\ifthenelse{\equal{#5}{ml_mass}}{
  \def\localxaxislabel{$\mlmass$ (\SI{}{\GeV})}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{m}$ (\SI{}{\GeV^{-1}})}
}{}
\ifthenelse{\equal{#5}{mt_tot_puppi}}{
  \def\localxaxislabel{$\mTtot$ (\SI{}{\GeV})}
  \def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{m}$ (\SI{}{\GeV^{-1}})}
}{}

}

\newcommand{\plotHTTcontrol}[5][\HTTplotsdir]{%
\begin{tikzpicture}%
\clip (0,.1) rectangle (7.76,7.7) ;
\begin{scope}
\clip (.45,.55) -- (.45,3) -- (.42,8) -- (1,8) -- (1,7.1) -- (7.76,7.1) -- (7.76,.55) -- cycle ;
\node[anchor=south west,inner sep=0] at (0,0) {\includegraphics[width=7.85cm]{\PhDthesisdir/plots_and_images/my_plots/#1/control_plots/Run#2_plots_#3/#4/Run#2_#4_#5.pdf}};
\end{scope}

\GETplotHTTcontrolINFO[#1]{#2}{#3}{#4}{#5}

% channel & cat
\draw (1, 7) node [above right] {\scriptsize \localchannel, \localcat\vphantom{Àq,}};

% year & lumi
\draw (7.7, 7) node [above left] {\scriptsize \SI{\locallumivalue}{\femto\barn^{-1}} (#2, \SI{13}{\TeV})\vphantom{Àq,}};

% axis labels
\draw (7.7, 0) node [above left] {\footnotesize \localxaxislabel\vphantom{Àq,}};
\draw (-.1, 7.3) node [below left, rotate=90] {\footnotesize \localyaxislabel\vphantom{Àq,}};

\draw (-.1, 1.75) node (tmp) [below, rotate=90] {\scriptsize \RatiosaxisA\vphantom{Àq,}};
\draw (tmp) node [below, rotate=90] {\scriptsize \RatiosaxisB\vphantom{Àq,}};

% CMS disclaimer
\draw (1.85, 7.05) node [below] {\scriptsize CMS Data\vphantom{Àq,}};
\draw (1.85, 6.55) node [below, text width=1cm] {\centering\scriptsize \WorkInProgress\par};
\end{tikzpicture}%
}

\newcommand{\GETplotHTTshapesINFO}[7][\HTTplotsdir]{%

% year
\ifthenelse{\equal{#4}{2016}}{\def\locallumivalue{35.9}}{}
\ifthenelse{\equal{#4}{2017}}{\def\locallumivalue{41.5}}{}
\ifthenelse{\equal{#4}{2018}}{\def\locallumivalue{59.7}}{}

% channel
\ifthenelse{\equal{#5}{tt}}{\def\localchannel{\tauh\tauh}\def\localLA{\ensuremath{\tauh^{(1)}}}\def\localLB{\ensuremath{\tauh^{(2)}}}}{}
\ifthenelse{\equal{#5}{mt}}{\def\localchannel{\mu\tauh}\def\localLA{\mu}\def\localLB{\ensuremath{\tauh}}}{}
\ifthenelse{\equal{#5}{et}}{\def\localchannel{\ele\tauh}\def\localLA{\ele}\def\localLB{\ensuremath{\tauh}}}{}
\ifthenelse{\equal{#5}{em}}{\def\localchannel{\ele\mu}\def\localLA{\ele}\def\localLB{\mu}}{}

% category and variable
\def\localBSMvar{\mTtot}
\ifthenelse{\equal{#2}{m_ml}}{\def\localBSMvar{\mml}}{}
\def\localSMvar{\NNscore}
\def\localSMvarBD{\text{\NNscore\ 2D}}
%\ifthenelse{\equal{#1}{HTT_v1}}{\def\localSMvar{\msv}}{}
\def\localcat{\InclusiveSTR{}}
\def\localvar{\localBSMvar}
\def\localBSM{}
\def\localSM{}
\ifthenelse{\equal{#3}{mssm_vs_sm_h125}}{\def\localBSM{\CATbsm\ }\def\localSM{\CATsm\ }}{}
\def\localSMBSM{}

\ifthenelse{\equal{#6}{1}}{
  \def\localcat{\CATxxh}
  \def\localvar{\localSMvarBD}
}{}
\ifthenelse{\equal{#6}{2}}{
  \def\localcat{\CATttbarctrl}
  \def\localvar{\localBSMvar}
  \def\localSMBSM{\localBSM}
}{}
\ifthenelse{\equal{#6}{13}}{
  \def\localcat{\CATttbar}
  \def\localvar{\localSMvar}
}{}
\ifthenelse{\equal{#6}{14}}{
  \def\localcat{\CATqcd}
  \def\localvar{\localSMvar}
}{}
\ifthenelse{\equal{#6}{15}}{
  \def\localcat{\CATzll}
  \def\localvar{\localSMvar}
}{}
\ifthenelse{\equal{#6}{16}}{
  \def\localcat{\CATmisc}
  \def\localvar{\localSMvar}
}{}
\ifthenelse{\equal{#6}{19}}{
  \def\localcat{\CATdib}
  \def\localvar{\localSMvar}
}{}
\ifthenelse{\equal{#6}{20}}{
  \def\localcat{\CATemb}
  \def\localvar{\localSMvar}
}{}
\ifthenelse{\equal{#6}{21}}{
  \def\localcat{\CATfake}
  \def\localvar{\localSMvar}
}{}
\ifthenelse{\equal{#6}{32}}{
  \def\localcat{\CATnobtag\ \CATtightmt}
    \ifthenelse{\equal{#5}{tt}}{
      \def\localcat{\CATnobtag}
    }{}
    \ifthenelse{\equal{#5}{em}}{
      \def\localcat{\CATnobtag\ \CAThighdz}
    }{}
  \def\localvar{\localBSMvar}
  \def\localSMBSM{\localBSM}
}{}
\ifthenelse{\equal{#6}{33}}{
  \def\localcat{\CATnobtag\ \CATloosemt}
    \ifthenelse{\equal{#5}{em}}{
      \def\localcat{\CATnobtag\ \CATmediumdz}
    }{}
  \def\localvar{\localBSMvar}
  \def\localSMBSM{\localBSM}
}{}
\ifthenelse{\equal{#6}{34}}{
  \def\localcat{\CATnobtag\ \CATlowdz}
  \def\localvar{\localBSMvar}
  \def\localSMBSM{\localBSM}
}{}
\ifthenelse{\equal{#6}{35}}{
  \def\localcat{\CATbtag\ \CATtightmt}
    \ifthenelse{\equal{#5}{tt}}{
      \def\localcat{\CATbtag}
    }{}
    \ifthenelse{\equal{#5}{em}}{
      \def\localcat{\CATbtag\ \CAThighdz}
    }{}
  \def\localvar{\localBSMvar}
  \def\localSMBSM{\localBSM}
}{}
\ifthenelse{\equal{#6}{36}}{
  \def\localcat{\CATbtag\ \CATloosemt}
    \ifthenelse{\equal{#5}{em}}{
      \def\localcat{\CATbtag\ \CATmediumdz}
    }{}
  \def\localvar{\localBSMvar}
  \def\localSMBSM{\localBSM}
}{}
\ifthenelse{\equal{#6}{37}}{
  \def\localcat{\CATbtag\ \CATlowdz}
  \def\localvar{\localBSMvar}
  \def\localSMBSM{\localBSM}
}{}

\ifthenelse{\equal{#3}{cut_based_sm}}{
\def\localSMvar{\msv}
\ifthenelse{\equal{#2}{m_ml}}{\def\localSMvar{\mml}}{}
\def\localBSMvar{\localSMvar}
\def\localvar{\localSMvar}

\def\localcat{\todo{???}}

\def\localBSM{}
\def\localSM{}
\def\localSMBSM{}

\ifthenelse{\equal{#5}{tt}}{
  \ifthenelse{\equal{#6}{10}}{
    \def\localcat{$\Njets=0, \Delta R < \num{3.2}$}
  }{}
  \ifthenelse{\equal{#6}{11}}{
    \def\localcat{$\Njets=1, \num{2.5} \leq \Delta R \!<\! \num{3.2}, \pT(\tau\tau) \!<\! \SI{100}{\GeV}$}
  }{}
  \ifthenelse{\equal{#6}{12}}{
    \def\localcat{$\Njets=1, \Delta R \!<\! \num{2.5}, \pT(\tau\tau) \!<\! \SI{100}{\GeV}$}
  }{}
  \ifthenelse{\equal{#6}{13}}{
    \def\localcat{$\Njets=1, \Delta R \!<\! \num{2.5}, \pT(\tau\tau) \geq \SI{100}{\GeV}$}
  }{}
  \ifthenelse{\equal{#6}{14}}{
    \def\localcat{$\Delta R \!<\! \num{2.5}, \mjj\!>\!\SI{350}{\GeV}, \Detajj\geq4$}
  }{}
  \ifthenelse{\equal{#6}{15}}{
    \def\localcat{$\Delta R \!<\! \num{2.5}, \mjj\!>\!\SI{350}{\GeV}, \Detajj\!<\!4$}
  }{}
  \ifthenelse{\equal{#6}{16}}{
    \def\localcat{$\Delta R \!<\! \num{2.5}, \mjj\!<\!\SI{350}{\GeV}$}
  }{}
  \ifthenelse{\equal{#6}{17}}{
    \def\localcat{$\binom{\Njets\geq2, \Delta R \geq \num{2.5}}{\Njets<2, \Delta R \geq \num{3.2}}$}
  }{}
}{}

\ifthenelse{\equal{#5}{mt}\or\equal{#5}{et}}{
  \ifthenelse{\equal{#6}{10}}{
    \def\localcat{$\Njets=0, \CATtightmt$}
  }{}
  \ifthenelse{\equal{#6}{11}}{
    \def\localcat{$\Njets=0, \CATloosemt$}
  }{}
  \ifthenelse{\equal{#6}{12}}{
    \def\localcat{$\Njets\geq1, \Delta R \geq \num{2.5}$}
  }{}
  \ifthenelse{\equal{#6}{13}}{
    \def\localcat{$\Njets=1, \Delta R \!<\! \num{2.5}, \pT(\tau\tau) \!<\! \SI{120}{\GeV}$}
  }{}
  \ifthenelse{\equal{#6}{14}}{
    \def\localcat{$\Njets=1, \Delta R \!<\! \num{2.5}, \SI{120}{\GeV} \!<\! \pT(\tau\tau) \!<\! \SI{200}{\GeV}$}
  }{}
  \ifthenelse{\equal{#6}{15}}{
    \def\localcat{$\Njets=1, \Delta R \!<\! \num{2.5}, \pT(\tau\tau) \!>\! \SI{200}{\GeV}$}
  }{}
  \ifthenelse{\equal{#6}{16}}{
    \def\localcat{$\Njets\geq2, \Delta R \!<\! \num{2.5}, \mjj \!<\! \SI{350}{\GeV}$}
    \def\localcat{$\Delta R \!<\! \num{2.5}, \mjj \!<\! \SI{350}{\GeV}$}
  }{}
  \ifthenelse{\equal{#6}{17}}{
    \def\localcat{$\Njets\geq2, \Delta R \!<\! \num{2.5}, \SI{350}{\GeV} \!<\! \mjj \!<\! \SI{1}{\TeV}$}
  }{}
  \ifthenelse{\equal{#6}{18}}{
    \def\localcat{$\Njets\geq2, \Delta R \!<\! \num{2.5}, \mjj \!>\! \SI{1}{\TeV}$}
    \def\localcat{$\Delta R \!<\! \num{2.5}, \mjj \!>\! \SI{1}{\TeV}$}
  }{}
}{}

\ifthenelse{\equal{#5}{em}}{
  \ifthenelse{\equal{#6}{10}}{
    \def\localcat{$\Njets=0, -35 \!<\! \Dzeta \!<\! -10, \pT(\tau\tau) \!>\! 10$}
  }{}
  \ifthenelse{\equal{#6}{11}}{
    \def\localcat{$\Njets=0, -35 \!<\! \Dzeta \!<\! -10, \pT(\tau\tau) \!<\! 10$}
  }{}
  \ifthenelse{\equal{#6}{12}}{
    \def\localcat{$\Njets=0, \Dzeta \!>\! -10, \pT(\tau\tau) \!>\! 10$}
  }{}
  \ifthenelse{\equal{#6}{13}}{
    \def\localcat{$\Njets=0, \Dzeta \!>\! -10, \pT(\tau\tau) \!<\! 10$}
  }{}
  \ifthenelse{\equal{#6}{14}}{
    \def\localcat{$\Njets=1, \SI{120} \!<\! \pT(\tau\tau) \!<\! \SI{200}{\GeV}$}
  }{}
  \ifthenelse{\equal{#6}{15}}{
    \def\localcat{$\Njets=1, \SI{40} \!<\! \pT(\tau\tau) \!<\! \SI{120}{\GeV}$}
  }{}
  \ifthenelse{\equal{#6}{16}}{
    \def\localcat{$\Njets=1, \pT(\tau\tau) \!>\! \SI{200}{\GeV}$}
  }{}
  \ifthenelse{\equal{#6}{17}}{
    \def\localcat{$\Njets=1, \pT(\tau\tau) \!<\! \SI{40}{\GeV}$}
  }{}
  \ifthenelse{\equal{#6}{18}}{
    \def\localcat{$\Njets\geq2, \mjj \!>\! \SI{350}{\GeV}$}
  }{}
  \ifthenelse{\equal{#6}{19}}{
    \def\localcat{$\Njets\geq2, \mjj \!<\! \SI{350}{\GeV}$}
  }{}
}{}

}{}

% axis labels
\def\localxaxislabel{\localvar\ifthenelse{\equal{\localvar}{\localBSMvar}}{ (\SI{}{\GeV})}{}}
\def\localyaxislabel{$\dd{\,\text{\Neventsaxis}}/\dd{\localvar}$\ifthenelse{\equal{\localvar}{\localBSMvar}}{ (\SI{}{\GeV^{-1}})}{}}

% CMS disclaimer
\def\localCMSdisclaimerAX{1.95}
\def\localCMSdisclaimerAY{7.05}
\def\localCMSdisclaimerBX{4.30}
\def\localCMSdisclaimerBY{7.05}
\ifthenelse{\equal{#5}{tt}}{ % tt
  \ifthenelse{\equal{#6}{20}\or\equal{#6}{16}}{ % EMB, misc
    \def\localCMSdisclaimerBX{\localCMSdisclaimerAX}
    \def\localCMSdisclaimerBY{\localCMSdisclaimerAY-.55}
  }{}
  \ifthenelse{\equal{#6}{21}}{
    \def\localCMSdisclaimerAX{3.65}
    \def\localCMSdisclaimerBX{5.05}
  }{}
}{}
\ifthenelse{\equal{#5}{mt}\or\equal{#5}{et}}{ % semi-leptonic
  \ifthenelse{\equal{#6}{13}}{ % ttbar
    \def\localCMSdisclaimerBX{\localCMSdisclaimerAX}
    \def\localCMSdisclaimerBY{\localCMSdisclaimerAY-.55}
  }{}
  \ifthenelse{\equal{#6}{21}\or\equal{#6}{20}\or\equal{#6}{16}\or\equal{#6}{15}}{ % fakes, emb, misc, zll
    \def\localCMSdisclaimerAX{6.5}
    \def\localCMSdisclaimerBX{\localCMSdisclaimerAX}
    \def\localCMSdisclaimerBY{\localCMSdisclaimerAY-.55}
  }{}
  \ifthenelse{\equal{#6}{16}\and\equal{#5}{mt}}{ % misc in mt
    \def\localCMSdisclaimerAX{1.95}
    \def\localCMSdisclaimerBX{\localCMSdisclaimerAX}
    \def\localCMSdisclaimerBY{\localCMSdisclaimerAY-.55}
  }{}
  \ifthenelse{\equal{#6}{15}\and\equal{#4}{2016}\and\equal{#5}{mt}}{ % 2016 zll in mt
    \def\localCMSdisclaimerAX{3.65}
    \def\localCMSdisclaimerAY{7.05}
    \def\localCMSdisclaimerBX{5.05}
    \def\localCMSdisclaimerBY{7.05}
  }{}
}{}
\ifthenelse{\equal{#5}{em}}{ % em
  \ifthenelse{\equal{#6}{20}\or\equal{#6}{19}\or\equal{#6}{14}}{ % EMB, diboson, qcd
    \def\localCMSdisclaimerBX{\localCMSdisclaimerAX}
    \def\localCMSdisclaimerBY{\localCMSdisclaimerAY-.55}
  }{}
  \ifthenelse{\equal{#6}{13}}{ % ttbar
    \def\localCMSdisclaimerAX{6.5}
    \def\localCMSdisclaimerBX{\localCMSdisclaimerAX}
    \def\localCMSdisclaimerBY{\localCMSdisclaimerAY-.55}
  }{}
  \ifthenelse{\equal{#6}{16}}{ % misc
    \def\localCMSdisclaimerAX{1.95}
    \def\localCMSdisclaimerAY{7.05}
    \def\localCMSdisclaimerBX{3.35}
    \def\localCMSdisclaimerBY{7.05}
  }{}
}{}
\ifthenelse{\equal{#7}{prefit}}{
  \def\localCMSdisclaimerAX{5.1}
  \def\localCMSdisclaimerAY{6}
  \def\localCMSdisclaimerBX{6.5}
  \def\localCMSdisclaimerBY{6}
}{}
\ifthenelse{\equal{#3}{cut_based_sm}}{
\def\localCMSdisclaimerAX{1.85}
\def\localCMSdisclaimerAY{7.05}
\def\localCMSdisclaimerBX{3.25}
\def\localCMSdisclaimerBY{7.05}
  \ifthenelse{\equal{#5}{tt}}{
    \def\localCMSdisclaimerBX{\localCMSdisclaimerAX}
    \def\localCMSdisclaimerBY{\localCMSdisclaimerAY-.55}
    \ifthenelse{\equal{#6}{10}}{
    \def\localCMSdisclaimerAX{6.5}
    \def\localCMSdisclaimerBX{\localCMSdisclaimerAX}
    \def\localCMSdisclaimerBY{\localCMSdisclaimerAY-.55}
    }{}
    \ifthenelse{\equal{#6}{17}}{
    \def\localCMSdisclaimerAX{4.1}
    \def\localCMSdisclaimerBX{\localCMSdisclaimerAX+2.4}
    \def\localCMSdisclaimerBY{\localCMSdisclaimerAY}
    }{}
  }{}
  \ifthenelse{\equal{#5}{mt}}{
    \def\localCMSdisclaimerBX{\localCMSdisclaimerAX}
    \def\localCMSdisclaimerBY{\localCMSdisclaimerAY-.55}
  }{}
  \ifthenelse{\equal{#5}{et}}{
    \def\localCMSdisclaimerBX{\localCMSdisclaimerAX}
    \def\localCMSdisclaimerBY{\localCMSdisclaimerAY-.55}
    \ifthenelse{\equal{#6}{11}\or\equal{#6}{12}}{
    \def\localCMSdisclaimerAX{6.5}
    }{}
  }{}
  \ifthenelse{\equal{#5}{em}}{
    \def\localCMSdisclaimerBX{\localCMSdisclaimerAX}
    \def\localCMSdisclaimerBY{\localCMSdisclaimerAY-.55}
  }{}
}{}

}

\newcommand{\plotHTTshapes}[7][\HTTplotsdir]{%
\begin{tikzpicture}%
\clip (0,.1) rectangle (7.76,7.7) ;
\begin{scope}
\clip (.5,.55) -- (.43,5) -- (.45,8) -- (1.1,8) -- (1.1,7.1) -- (7.76,7.1) -- (7.76,.55) -- cycle ;
\ifthenelse{\equal{#6}{2}\or\equal{#6}{32}\or\equal{#6}{33}\or\equal{#6}{34}\or\equal{#6}{35}\or\equal{#6}{36}\or\equal{#6}{37}}{
\clip (.5,.55) -- (.43,5) -- (.43,5.55) -- (.5,5.55) -- (.5,5.65) -- (.43,5.65) -- (.45,8) -- (1.1,8) -- (1.1,7.1) -- (7.76,7.1) -- (7.76,.55) -- cycle ;
}{}
\node[anchor=south west,inner sep=0] at (0,0) {\includegraphics[width=7.85cm]{\PhDthesisdir/plots_and_images/my_plots/#1/#2-#3/#4/cmb/#4_#5_#6_#7.pdf}};
\end{scope}

\GETplotHTTshapesINFO[#1]{#2}{#3}{#4}{#5}{#6}{#7}

% year and lumi
\draw (7.7, 7) node [above left] {\scriptsize \SI{\locallumivalue}{\femto\barn^{-1}} (#4, \SI{13}{\TeV})\vphantom{Àq,}};

% channel and cats
\draw (1, 7) node [above right] {\scriptsize \localchannel, \localSMBSM\localcat\vphantom{Àq,}};

% axis labels
\draw (7.7, 0) node [above left] {\footnotesize \localxaxislabel\vphantom{Àq,}};
\draw (-.1, 7.3) node [below left, rotate=90] {\footnotesize \localyaxislabel\vphantom{Àq,}};

\draw (-.1, 1.75) node (tmp) [below, rotate=90] {\scriptsize \RatiosaxisA\vphantom{Àq,}};
\draw (tmp) node [below, rotate=90] {\scriptsize \RatiosaxisB\vphantom{Àq,}};

% CMS disclaimer
\draw (\localCMSdisclaimerAX, \localCMSdisclaimerAY) node [below] {\scriptsize CMS Data\vphantom{Àq,}};
\draw (\localCMSdisclaimerBX, \localCMSdisclaimerBY) node [below, text width=1.5cm] {\centering\scriptsize \WorkInProgress\par};
\end{tikzpicture}%
}

\newcommand{\plotHTTcontrolCATmt}[4][\HTTplotsdir]{%
\begin{tikzpicture}%
\node[anchor=south west] at (0,0) {\plotHTTcontrol[#1]{#2}{#3}{#4}{mt_1_puppi}};

\foreach \x in {40, 70}{
 \draw [thick, dashed] ({1.25 + (\x-0)/(160-0)*(7.68-1.25)}, 2.8) --+ (0, 5.6-2.8);
 \draw [thick, dashed] ({1.25 + (\x-0)/(160-0)*(7.68-1.25)}, 0.95) --+ (0, 2.2-0.95);
}

\draw ({1.25 + (20-0)/(160-0)*(7.68-1.25)}, 5.6) node {\tiny \CATtightmt};
\draw ({1.25 + (55-0)/(160-0)*(7.68-1.25)}, 5.6) node {\tiny \CATloosemt};
\draw ({1.25 + (115-0)/(160-0)*(7.68-1.25)}, 5.6) node {\tiny DR \Wjets};
\end{tikzpicture}%
}

\newcommand{\plotHTTcontrolCATdz}[4][\HTTplotsdir]{%
\begin{tikzpicture}%
\node[anchor=south west] at (0,0) {\plotHTTcontrol[#1]{#2}{#3}{#4}{pZetaPuppiMissVis}};

\foreach \x in {-35, -10, 30}{
 \draw [thick, dashed] ({1.25 + (\x+200)/(200+200)*(7.68-1.25)}, 2.8) --+ (0, 5.6-2.8);
 \draw [thick, dashed] ({1.25 + (\x+200)/(200+200)*(7.68-1.25)}, 0.95) --+ (0, 2.2-0.95);
}

\draw ({1.25 + (-117.5+200)/(200+200)*(7.68-1.25)}, 5.6) node [below] {\tiny CR \ttbar};
\draw ({1.25 + (-22.5+200)/(200+200)*(7.68-1.25)}, 5.6+.25) node [left, rotate=90] {\tiny \CATlowdz};
\draw ({1.25 + (20+200)/(200+200)*(7.68-1.25)}, 5.6+.25) node [left, rotate=90] {\tiny \CATmediumdz};
\draw ({1.25 + (115+200)/(200+200)*(7.68-1.25)}, 5.6) node [below] {\tiny \CAThighdz};
\end{tikzpicture}%
}

% JERC
\newcommand{\Rbal}{{\ensuremath{R_{\mathit{bal}}}}}
\newcommand{\RMPF}{{\ensuremath{R_{\mathit{MPF}}}}}
\newcommand{\kT}{{\ensuremath{k_{\mathrm{T}}}}}

\newcommand{\ptcl}{{\text{\rm ptcl}}}
\newcommand{\reco}{{\text{\rm reco}}}
\newcommand{\cali}{{\text{\rm corr}}}

\newcommand{\Gjet}{$\photon+\text{jet}$}
\newcommand{\Gjets}{$\photon+\text{jets}$}
\newcommand{\Zjet}{$\Zboson+\text{jet}$}
\newcommand{\Zjets}{$\Zboson+\text{jets}$}
\newcommand{\Zeejet}{$\Zboson(\to\antielectron\electron)+\text{jet}$}
\newcommand{\Zeejets}{$\Zboson(\to\antielectron\electron)+\text{jets}$}
\newcommand{\Zmmjet}{$\Zboson(\to\antimuon\muon)+\text{jet}$}
\newcommand{\Zmmjets}{$\Zboson(\to\antimuon\muon)+\text{jets}$}

% CMS disclaimers
\newcommand{\OwnWork}{\emph{Own work}}
\newcommand{\WorkInProgress}{\emph{Work in progress}}


% HTT selections
\newcommand{\AllSatisfyingFollowing}[2]{Tout #1{} respectant les critères listés ci-après est retenu pour jouer le rôle de #2 dans le dilepton}

\newcommand{\TauHdz}{$d_z < \SI{0.2}{\centi\meter}$ avec $d_z$ la distance entre la trace principale du \tauh\ et le vertex primaire d'interaction}
\newcommand{\Leptondzdxy}{paramètres d'impact $d_z < \SI{0.2}{\centi\meter}$ et $d_{xy} < \SI{0.045}{\centi\meter}$}

\newcommand{\RelIsoBelow}[2]{$I^{#1} < \num{#2} \, \pT^{#1}$}

\newcommand{\MuonIDWP}[2]{point de fonctionnement #1 (\emph{#2}) du \muonID}
\newcommand{\MediumMuonID}{\MuonIDWP{moyen}{medium}}
\newcommand{\LooseMuonID}{\MuonIDWP{relâché}{loose}}

\newcommand{\NinetyNineEleMVA}{point de fonctionnement à \SI{90}{\%} d'efficacité de l'\EleIDMVA}
\newcommand{\NinetyNineEleMVAnoIso}{\NinetyNineEleMVA\ sans utilisation des variables d'isolation}

\newcommand{\NewDecayModeFinding}[1][]{passer le discriminateur \texttt{NewDecayModeFinding} (modes de désintégration 5, 6, et 7 interdits)}
\newcommand{\PassDeepTau}[3]{#1 (\emph{#2}) du discriminateur \texttt{deepTau #3}}

\newcommand{\AtLeastOneOSPair}[1]{L'événement est retenu à condition qu'au moins une paire $L_1L_2=#1$ puisse être construite avec $L_1$ et $L_2$ de charges électriques opposées.}
\newcommand{\DeltaRPair}[1]{Il est de plus requis que $L_1$ et $L_2$ soient séparés dans le plan $(\eta,\phi)$ tel que $\Delta R > \num{#1}$.}
\newcommand{\IfMoreOnePair}{Si plus d'une paire possible existe dans l'événement, une seule est retenue selon la logique exposée dans la section~\ref{chapter-HTT_analysis-section-offline-dilepton}.}

\newcommand{\FromPairMatchToHLTObjects}{de la paire sélectionnée doivent correspondre, le cas échéant, aux objets ayant activé un des \HLTpaths\ utilisé pour enregistrer l'événement.
Les objets considérés pour chacun des \HLTpaths\ sont donnés dans l'annexe~\refApHTTtrg.
La correspondance est établie lorsque la particule reconstruite et l'objet du \HLTpath\ sont séparés de moins de \num{0.5} dans le plan $(\eta,\phi)$, \ie\ $\Delta R < \num{0.5}$.
Ce critère est appliqué de manière cohérente dans les données réelles, simulées et encapsulées.}
\newcommand{\HLTregionsDefined}{catégories sont définies pour les événements enregistrés en 2016 (respectivement 2017 et 2018)}

\newcommand{\TransverseMassWjetsInfosTXT}{Cette coupure permet de s'assurer que la région de signal soit orthogonale à la région de détermination des facteurs de faux des événements $\Wboson+\text{jets}$. Les facteurs de faux sont abordés dans la section~\ref{chapter-HTT_analysis-section-bg_estimation-FF_method}.}

\newcommand{\TransverseMassWjets}[4][]{La masse transverse #2, définie par
\begin{equation}
\mT^{#3} = \mT(#3, \MET) = \sqrt{2 \, \pT^{#3} \, \MET \, (1-\cos\Delta\phi)}
\end{equation}
avec $\Delta\phi = \phi^{#3} - \phi^{\MET}$
doit vérifier $\mT < \SI{70}{\GeV}$. \TransverseMassWjetsInfosTXT}

\newcommand{\DzetaEleMU}{

\begin{wrapfigure}[17]{R}{.45\textwidth}
\centering
\vspace{-2\baselineskip}
\begin{tikzpicture}
%% base
\draw [->] (0,0)--(2,0) node [right] {$\bvec_x$};
\draw [->] (0,0)--(0,2) node [above] {$\bvec_y$};

\def\xMET{-1.5}
\def\yMET{-1.25}
\def\xELE{2}
\def\yELE{3}
\def\xMU{.5}
\def\yMU{-2}

\draw [thick, -latex, ltcolorred] (0,0) -- (\xMET,\yMET) coordinate (vMET);
\draw [ltcolorred] (vMET) node [below] {\vMET};
\draw [thick, -latex, ltcolorblue] (0,0) -- (\xELE,\yELE) coordinate (vE);
\draw [ltcolorblue] (vE) node [right] {$\vpT^{\ele}$};
\draw [thick, -latex, ltcolorblue] (0,0) -- (\xMU,\yMU) coordinate (vM);
\draw [ltcolorblue] (vM) node [right] {$\vpT^{\mu}$};

\draw [dashed, -latex] ({-\xELE+-\xMU}, {-\yELE+-\yMU}) -- ({1.25*(\xELE+\xMU)}, {1.25*(\yELE+\yMU)}) node [above] {$\vec{\zeta}$};

\draw [thick, ltcolorgreen, -latex] (0,0) -- ({\xELE+\xMU}, {\yELE+\yMU}) coordinate (vVIS);
\draw [ltcolorgreen] (vVIS) node [below right] {$\vpTvis$};

\draw [thick, -latex, ltcolorred4] (0,0) --+ ({180+acos((\xELE+\xMU)/(((\xELE+\xMU)*(\xELE+\xMU)+(\yELE+\yMU)*(\yELE+\yMU))^(0.5)))}:{(\xMET*\xMET+\yMET*\yMET)^(0.5)*cos(180-acos((\xELE+\xMU)/(((\xELE+\xMU)*(\xELE+\xMU)+(\yELE+\yMU)*(\yELE+\yMU))^(0.5)))-acos((\xMET)/((\xMET*\xMET+\yMET*\yMET)^(0.5))))})  coordinate (vMETzeta) ;
\draw [ltcolorred4] (vMETzeta) node [above] {$p_\zeta^\text{miss}\hat{\zeta}$};

\draw [dotted] (vMET) -- (vMETzeta);
\draw [dotted] (vE) -- (vVIS);
\draw [dotted] (vM) -- (vVIS);

\end{tikzpicture}
\caption{Illustration de la définition de $\hat{\zeta}$~\cite{Jang_thesis}. Le plan de ce schéma est le plan transverse.}
\label{fig-zeta_illustration}
\end{wrapfigure}

La variable \Dzeta\ est définie selon
\begin{equation}
\Dzeta = p_\zeta^\text{miss} - \num{0.85} p_\zeta^{(\tau\tau)}
\label{eq-Dzeta_def}
\end{equation}
avec
\begin{equation}
p_\zeta^\text{miss} = \vMET \cdot \hat{\zeta}
\msep
p_\zeta^{(\tau\tau)} = \vpTvis \cdot \hat{\zeta}
\end{equation}
où $\hat{\zeta}$ est la direction bisectionnelle entre l'électron et le muon dans le plan transverse~\cite{Jang_thesis}
et
\begin{equation}
\vpTvis = \vpT^{\ele} + \vpT^{\mu}
\label{eq-pTvis_def}
\end{equation}
comme illustré sur la figure~\ref{fig-zeta_illustration}.
Il est requis que $\Dzeta \geq \num{-35}$ afin de s'assurer que la région de signal soit orthogonale à la région de contrôle (CR) du bruit de fond \ttbar.}

\newcommand{\LeptonVetoes}{Les vetos de leptons supplémentaires doivent être respectés, \ie\ que l'événement ne contient pas:}

\newcommand{\LeptonVetoesExtra}[6]{#1 tel que $\pT^{#2} > \SI{#3}{\GeV}$, $\abs{\eta^{#2}} < \num{#4}$, passant le #5 et d'isolation \RelIsoBelow{#2}{#6}}
\newcommand{\LeptonVetoesExtraMuon}{\LeptonVetoesExtra{de muon}{\mu}{10}{2.4}{\MediumMuonID}{0.3}}
\newcommand{\LeptonVetoesExtraMuonMuMu}{\LeptonVetoesExtra{de muon supplémentaire}{\mu}{10}{2.4}{\MediumMuonID}{0.3}}
\newcommand{\LeptonVetoesSecondMuon}{\LeptonVetoesExtra{de second muon}{\mu}{10}{2.4}{\MediumMuonID}{0.3}}
\newcommand{\LeptonVetoesExtraEle}{\LeptonVetoesExtra{d'électron}{\ele}{10}{2.5}{\NinetyNineEleMVA}{0.3}}
\newcommand{\LeptonVetoesExtraEleEleEle}{\LeptonVetoesExtra{d'électron supplémentaire}{\ele}{10}{2.5}{\NinetyNineEleMVA}{0.3}}
\newcommand{\LeptonVetoesSecondEle}{\LeptonVetoesExtra{de second électron}{\ele}{10}{2.5}{\NinetyNineEleMVA}{0.3}}

\newcommand{\LeptonVetoesPair}[7]{de paire #1 de charges opposées avec $\Delta R > \num{#2}$, tous deux vérifiant $\pT^{#3} > \SI{#4}{\GeV}$, $\abs{\eta^{#3}} < \num{#5}$, passant le #6, de paramètres d'impact $d_z < \SI{0.2}{\centi\meter}$ et $d_{xy} < \SI{0.045}{\centi\meter}$ et d'isolation \RelIsoBelow{#3}{#7}}
\newcommand{\LeptonVetoesMuonPair}{\LeptonVetoesPair{de muons}{0.15}{\mu}{15}{2.4}{\LooseMuonID}{0.3}}
\newcommand{\LeptonVetoesElectronPair}{\LeptonVetoesPair{d'électrons}{0.15}{\ele}{15}{2.5}{\CutBasedEleIDVeto}{0.3}}

\newcommand{\LessTwoMissingHitsVertex}{présenter moins de deux points de passage manquants dans le trajectographe}
\newcommand{\PassConversionVeto}{passer le veto d'électron de conversion}

%%%%%%

\renewcommand{\MuonIDWP}[2]{point de fonctionnement \emph{#2} du \muonID}
\renewcommand{\PassDeepTau}[3]{\emph{#2} du discriminateur \texttt{deepTau #3}}



%% ML

\newcommand{\ytrue}{\ensuremath{y_{\text{\rm vraie}}}}
\newcommand{\ypred}{\ensuremath{y_{\text{\rm préd}}}}
\newcommand{\ytruei}{\ensuremath{y_{\text{\rm vraie},i}}}
\newcommand{\ypredi}{\ensuremath{y_{\text{\rm préd},i}}}

\newcommand{\Loss}{\ensuremath{\mathsf{L}}}
\newcommand{\LossMSE}{\ensuremath{\Loss_\mathrm{MSE}}}
\newcommand{\LossMAE}{\ensuremath{\Loss_\mathrm{MAE}}}
\newcommand{\LossMAPE}{\ensuremath{\Loss_\mathrm{MAPE}}}
\newcommand{\LossMAPEsqrt}{\ensuremath{\Loss_\mathrm{MA\sqrt{P}E}}}
\newcommand{\LossMAPEsqrtb}{\ensuremath{\Loss_\mathrm{MA\sqrt{P}E\times b}}}

\newcommand{\OneSigmaWidth}{\ensuremath{\Delta_{1\sigma}}}
\newcommand{\TwoSigmaWidth}{\ensuremath{\Delta_{2\sigma}}}

\newcommand{\NNeurons}{\ensuremath{N_\text{n\!/\!c}}}
\newcommand{\NLayers}{\ensuremath{N_\text{cc}}}

\newcommand{\MinChildWeight}{\ensuremath{N^\text{échant.}_\text{\rm min}}}
\newcommand{\MaxDepth}{\ensuremath{N^\text{prof.}_\text{\rm max}}}
\newcommand{\Nestimators}{\ensuremath{N^\text{estim.}_\text{\rm max}}}

\newcommand{\Nnu}{\ensuremath{N^\text{reco}_{\nu}}}
\newcommand{\Npu}{\ensuremath{N_{\mathrm{PU}}}}
\newcommand{\AddHadAct}{\textrm{AHA}}
\newcommand{\Njetsr}{\ensuremath{N_{\textrm{jets}}^{\AddHadAct}}}